# Cleanup & Excel Usage Guide

## Part 1: Files to Delete (Outdated)

### ‚ùå Delete These Files

```bash
# Old workflow files (replaced by JSON workflow)
3d_product_database.txt          ‚Üê Old text-based database
worksheet_events.txt             ‚Üê Old VBA reference

# Old/redundant VBA files
ExcelViewerModule.vba            ‚Üê Old version (replaced by _FIXED)
ExcelViewerModule_FIXED.vba      ‚Üê VBA now embedded in .xlsm, not needed externally

# Redundant documentation
README.md                        ‚Üê Old readme
WORKFLOW.md                      ‚Üê Old workflow (use COMPLETE_WORKFLOW.md)
SINGLE_FILE_WORKFLOW.md          ‚Üê Redundant
RESTRUCTURE_PLAN.md              ‚Üê Planning doc, no longer needed
FIXES_APPLIED.md                 ‚Üê Historical, can delete
setup_instructions.md            ‚Üê Old setup (covered in COMPLETE_WORKFLOW)

# Old migration scripts (only needed once)
migrate_to_json.py               ‚Üê One-time migration, delete after use
merge_notes.py                   ‚Üê Old notes merger

# Old Rhino script (replaced by plugin)
bosch_rhino_script_updated.py    ‚Üê Old approach, plugin will replace this
```

### ‚úÖ Keep These Files

```bash
# Core workflow
COMPLETE_WORKFLOW.md             ‚Üê Main guide (read this!)
TEMPLATE_minimal.json            ‚Üê Starter template

# Active scripts
autopop_product_json.py          ‚Üê Auto-fills JSON files
autopop_product_json.bat         ‚Üê Runs auto-populator

bosch_scanner.py                 ‚Üê Scans JSON ‚Üí products.json
scan_database.bat                ‚Üê Runs scanner

populate_excel.py                ‚Üê Updates Excel from products.json
populate_excel.bat               ‚Üê Runs Excel updater

# Data files
products.json                    ‚Üê Generated by scanner
GBL 18V-750.json                 ‚Üê Example product JSON

# Excel file
Bosch_3D_ProductDatabase_clean.xlsm  ‚Üê Main Excel database
```

---

## Part 2: Excel Usage Guide

### Overview

The Excel file is a **VIEW** of your product database. It's automatically generated from JSON files.

**Workflow:**
```
JSON files ‚Üí products.json ‚Üí Excel
  (source)    (scanner)     (viewer)
```

### Step-by-Step: Populate Excel

#### 1. Create Product JSONs
```bash
# Create minimal JSONs for your products
Copy TEMPLATE_minimal.json ‚Üí GBL 18V-750.json
Edit: name, description, SKU, holders

# Run auto-populator
autopop_product_json.bat
```

#### 2. Generate products.json
```bash
# Scanner reads all JSONs, creates products.json
scan_database.bat
```

**Output:** `products.json` (consolidated database)

#### 3. Update Excel
```bash
# Excel updater reads products.json, updates Excel
populate_excel.bat
```

**Output:** Excel file updated with all products!

---

## Excel File Structure

### Row 1: Action Buttons
```
| SCAN DATABASE | REFRESH EXCEL | INSERT PREVIEWS | EXPORT NOTES |
```

**Buttons:**
- **SCAN DATABASE** - Runs scanner (JSON ‚Üí products.json)
- **REFRESH EXCEL** - Updates Excel from products.json
- **INSERT PREVIEWS** - Embeds preview images in cells
- **EXPORT NOTES** - Exports notes to CSV

### Row 2: Headers
```
Product Name | SKU | Description | Range | Category | Holders | ... | Notes
```

### Row 3+: Product Data
Each row = one product, auto-populated from JSON

---

## Using Excel

### View Products
1. Open `Bosch_3D_ProductDatabase_clean.xlsm`
2. Browse products in table
3. Click SKU hyperlinks ‚Üí opens product folder
4. View holder previews (if images inserted)

### Search & Filter
```
Excel menu ‚Üí Data ‚Üí Filter
Or: Ctrl+Shift+L
```

**Filter by:**
- Range (PRO/DIY)
- Category (Garden, Drills, Saws)
- Has Packaging (Yes/No)
- Tags

### Add Notes
1. Click in Notes column (last column)
2. Type notes
3. Save Excel file

**Notes persist!** They won't be overwritten when you refresh.

### Insert Preview Images
1. Click **INSERT PREVIEWS** button
2. Wait (script embeds images)
3. Preview thumbnails appear in cells

**Note:** This can be slow with many products. Run once, save file.

### Export Data
1. Click **EXPORT NOTES** button
2. Creates CSV with product names + notes
3. Use for reports, sharing, etc.

---

## Daily Workflow

### Add New Products
```bash
1. Create JSON: GBL 18V-750.json (2 min)
2. Run: autopop_product_json.bat
3. Run: scan_database.bat
4. Run: populate_excel.bat
5. Open Excel ‚Üí new products appear!
```

### Update Existing Products
```bash
1. Edit JSON files (add holders, change description)
2. Run: autopop_product_json.bat (validates)
3. Run: scan_database.bat (updates products.json)
4. Run: populate_excel.bat (refreshes Excel)
```

### Just View Data
```bash
1. Open Excel file
2. Filter, search, browse
3. No scripts needed!
```

---

## Excel Features Explained

### Holder Dropdowns
**Future feature** (not yet implemented):
- Each holder cell will have dropdown
- Select from available holders
- Preview updates automatically

**For now:** Holders shown as comma-separated list

### Hyperlinks
- **SKU column:** Links to product folder
- **Holder names:** Will link to holder files (future)

### Images
- Preview images embedded after clicking INSERT PREVIEWS
- Images stored in Excel file (increases file size)

### VBA Macros
Excel file contains VBA for:
- Button actions
- Image insertion
- Note export
- Auto-refresh features

**Keep macros enabled!** (Trust the file when opening)

---

## Maintenance

### Excel File Gets Too Big
**Problem:** Too many embedded images

**Solution:**
```bash
1. Don't click INSERT PREVIEWS (view images in folders instead)
2. Or: Remove images, save, re-insert only when needed
```

### Excel Shows Old Data
**Problem:** Excel not refreshed after JSON changes

**Solution:**
```bash
1. Run: scan_database.bat
2. Run: populate_excel.bat
3. Open Excel (or click REFRESH EXCEL button)
```

### Products Missing from Excel
**Problem:** Scanner didn't find JSON

**Solution:**
```bash
1. Check JSON exists: PRO\Garden\ProductName\ProductName.json
2. Check JSON is valid (no syntax errors)
3. Run scanner with error output:
   python bosch_scanner.py
```

---

## Advanced: Excel Customization

### Add Custom Columns
```python
# Edit: populate_excel.py
# Find: headers = [...]
# Add your column

# Then run populate_excel.bat
```

### Change Styling
```python
# Edit: populate_excel.py
# Modify: cell colors, fonts, borders
```

### Add More Buttons
```vba
# Open Excel ‚Üí Developer tab ‚Üí Visual Basic
# Edit: Module1
# Add new Sub procedures for buttons
```

---

## Quick Reference

### File Locations
```
Product JSONs:    M:\...\Tools and Holders\PRO\Garden\ProductName\ProductName.json
products.json:    E:\CURSOR\...\Bosch Products DB in excel\products.json
Excel file:       E:\CURSOR\...\Bosch_3D_ProductDatabase_clean.xlsm
```

### Commands
```bash
autopop_product_json.bat    # Step 1: Auto-fill JSONs
scan_database.bat           # Step 2: JSON ‚Üí products.json
populate_excel.bat          # Step 3: products.json ‚Üí Excel
```

### Excel Buttons
```
SCAN DATABASE    ‚Üí Runs scan_database.bat
REFRESH EXCEL    ‚Üí Runs populate_excel.bat
INSERT PREVIEWS  ‚Üí Embeds images
EXPORT NOTES     ‚Üí Creates CSV
```

---

## Troubleshooting

### "Macro security warning"
**Fix:** Enable macros (required for buttons to work)

### "Python not found"
**Fix:** Install Python 3.7+, add to PATH

### "Module not found" (openpyxl)
**Fix:** `pip install openpyxl`

### Excel buttons don't work
**Fix:** 
1. Check macros enabled
2. Check batch files exist in same folder
3. Right-click button ‚Üí Assign Macro ‚Üí verify macro name

### Preview images don't insert
**Fix:**
1. Check preview files exist in product folders
2. Check file paths in JSON are correct
3. Run with Excel open, check VBA errors (Alt+F11)

---

## Summary

‚úÖ **Excel is a viewer** - generated from JSON files  
‚úÖ **Use batch files** - automate everything  
‚úÖ **Notes persist** - safe to add notes in Excel  
‚úÖ **Images optional** - slow to embed, keep for presentation only  
‚úÖ **Filter & search** - Excel's built-in tools work perfectly  

**Read COMPLETE_WORKFLOW.md for the full picture!** üìñ
